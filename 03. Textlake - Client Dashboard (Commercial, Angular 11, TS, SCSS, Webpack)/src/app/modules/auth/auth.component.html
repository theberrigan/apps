<ng-container [ngSwitch]="action" *ngIf="isReady">
    <token-handler *ngSwitchCase="'handle-token'" (onAfterSignIn)="onAfterSignIn()"></token-handler>
    <div class="auth__table" *ngSwitchDefault>
        <div class="auth__table-row">
            <div class="auth__table-cell auth__table-cell_small">
                <div class="auth__logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 159 36" class="auth__logo-img">
                        <g style="fill: #fff;">
                            <path d="M158.6,7.09c0,.54,0,1.08-.07,1.62s-.08,1.09-.15,1.64h-.53L157,8.14h-4.4v5.32h3.29l.79-1.49h.5a34.37,34.37,0,0,1,0,4.06h-.5l-.79-1.53h-3.29v5.6h4.64l1-2.41h.5a16.27,16.27,0,0,1,.2,1.71,14.58,14.58,0,0,1,0,1.75H149v-.59a6.86,6.86,0,0,1,1.66-.48V8.18c-.28-.06-.56-.13-.83-.21L149,7.68V7.09Zm-17.3,0h4.45v.59c-.25.11-.52.21-.78.3s-.51.14-.75.2l-4.05,5.34c.33.44.72.93,1.16,1.48s.89,1.12,1.37,1.7,1,1.17,1.47,1.77,1,1.16,1.48,1.69l1,.49v.5H144.1l-.69-.48q-1.18-1.4-2.37-3c-.78-1.07-1.55-2.15-2.28-3.25h-1v5.66a5,5,0,0,1,1.51.48v.59h-5.1v-.59a9.45,9.45,0,0,1,1.65-.48V8.18a5.08,5.08,0,0,1-1.65-.5V7.09h5.1v.59l-.71.27c-.25.08-.52.16-.8.23v5.56l1.21-.28,3.77-5.28c-.27-.07-.53-.14-.77-.22a5.72,5.72,0,0,1-.68-.28ZM122.46,21.15H118v-.58a8.54,8.54,0,0,1,1.45-.49l5.1-13.23h.59l5.1,13.23.8.18a2.77,2.77,0,0,1,.73.31v.58h-5.2v-.58a8.15,8.15,0,0,1,.83-.29c.28-.08.56-.14.82-.2l-1.36-3.67h-4.79l-1.33,3.67a7,7,0,0,1,1.74.49Zm0-5.78h4l-1.58-4.26-.39-1.73h0l-.5,1.77ZM105.51,7.09H111v.59c-.33.12-.65.22-1,.31a7.92,7.92,0,0,1-1,.19V20.1h4.64l1.19-3.23h.52c0,.28.08.61.11,1s.06.75.08,1.15,0,.78,0,1.15,0,.71,0,1H105.51v-.58a4.76,4.76,0,0,1,.89-.33c.27-.06.52-.12.77-.16V8.18a6.77,6.77,0,0,1-.89-.21,7.15,7.15,0,0,1-.77-.29ZM99.89,21.15H94.23v-.58a9.24,9.24,0,0,1,.89-.29c.32-.08.65-.15,1-.2V8.14H93L92,11h-.51c0-.27-.07-.57-.1-.91s0-.69-.07-1,0-.7,0-1,0-.65,0-.92h11.72c0,.27,0,.57,0,.91s0,.68-.05,1,0,.7-.07,1.05,0,.65-.09.93h-.53L101.1,8.14H98V20.08l1,.2a4.54,4.54,0,0,1,.88.29ZM83.82,7.09h4.64v.59L87.73,8,87,8.18,83.4,13.62l4.13,6.46a6.28,6.28,0,0,1,1.65.49v.58H83.82v-.58a4.89,4.89,0,0,1,1.53-.49l-3.18-5L79.1,20.1c.29,0,.56.09.83.15a2.85,2.85,0,0,1,.79.32v.58H76.06v-.58a3.91,3.91,0,0,1,.76-.31l.73-.18,4-6-3.79-5.9-.79-.24-.8-.26V7.09h5.34v.59l-.67.24-.86.26,2.82,4.53L85.5,8.18a14.08,14.08,0,0,1-1.68-.5Zm-10.95,0c0,.54,0,1.08-.07,1.62s-.09,1.09-.15,1.64h-.53L71.3,8.14H66.9v5.32h3.29L71,12h.51a34.37,34.37,0,0,1,0,4.06H71l-.78-1.53H66.9v5.6h4.64l1-2.41H73c.09.57.16,1.13.2,1.71a14.58,14.58,0,0,1,0,1.75H63.31v-.59A6.79,6.79,0,0,1,65,20.08V8.18c-.27-.06-.55-.13-.82-.21l-.83-.29V7.09ZM57.69,21.15H52v-.58c.3-.11.6-.21.9-.29s.65-.15,1-.2V8.14H50.81L49.75,11h-.51c0-.27-.07-.57-.1-.91s0-.69-.07-1,0-.7,0-1,0-.65,0-.92H60.71c0,.27,0,.57,0,.91s0,.68,0,1l-.06,1.05q0,.51-.09.93H60L58.9,8.14H55.83V20.08l1,.2a4.54,4.54,0,0,1,.88.29Zm-5,8.67H53c0,.09,0,.19.06.31s0,.25.05.38l0,.41c0,.13,0,.25,0,.36a1.92,1.92,0,0,1-.7.24,4.91,4.91,0,0,1-.86.08,4.11,4.11,0,0,1-1.21-.17A2.22,2.22,0,0,1,48.9,30a3.73,3.73,0,0,1-.21-1.32,3.3,3.3,0,0,1,.23-1.31,2.52,2.52,0,0,1,.61-.9,2.38,2.38,0,0,1,.89-.51,3.43,3.43,0,0,1,1.07-.17,5.44,5.44,0,0,1,.95.08,3,3,0,0,1,.7.2c0,.09,0,.2,0,.33s0,.28,0,.42l-.06.43-.07.36h-.34l-.44-1.21a.74.74,0,0,0-.23-.06,1.84,1.84,0,0,0-.33,0,1.4,1.4,0,0,0-.61.14,1.14,1.14,0,0,0-.51.42,2.13,2.13,0,0,0-.36.74A4.24,4.24,0,0,0,50,28.7a3,3,0,0,0,.45,1.76,1.46,1.46,0,0,0,1.24.62,1.92,1.92,0,0,0,.38,0,.37.37,0,0,0,.21-.1ZM57.1,25.9h2.63v.3a2.15,2.15,0,0,1-.38.15,2.74,2.74,0,0,1-.39.09V31H60.5L61,29.55h.33c0,.12,0,.26.06.43s0,.34,0,.52,0,.36,0,.54a3.52,3.52,0,0,1,0,.46H57.1v-.3a2.6,2.6,0,0,1,.35-.16l.31-.08V26.44a1.78,1.78,0,0,1-.66-.24Zm10.7,5.6H65.31v-.3A2,2,0,0,1,66,31V26.44l-.33-.09a1.28,1.28,0,0,1-.31-.15v-.3H67.8v.3a1.48,1.48,0,0,1-.31.15l-.34.09V31l.34.09a1.48,1.48,0,0,1,.31.15Zm8-5.6c0,.24,0,.49,0,.74a6.85,6.85,0,0,1-.11.72h-.33L75,26.42h-1.5v2h1l.35-.62h.25a7.89,7.89,0,0,1,.05.88,8.22,8.22,0,0,1-.05.89h-.25l-.35-.63h-1V31h1.56l.42-1h.33c0,.11,0,.22.07.35s0,.26,0,.39l0,.42c0,.13,0,.26,0,.38H71.63v-.3l.31-.14.35-.1V26.44a2.56,2.56,0,0,1-.34-.1,1.55,1.55,0,0,1-.32-.14v-.3Zm7.78,0h2v.31a1.63,1.63,0,0,1-.34.21,1.36,1.36,0,0,1-.34.14v5h-.68l-2.82-4.08-.32-.62h0l.07.64v3.34a1.58,1.58,0,0,1,.36.13,1.69,1.69,0,0,1,.33.19v.3h-2v-.3a2.4,2.4,0,0,1,.67-.32V26.52l-.32-.15a1.58,1.58,0,0,1-.29-.17v-.3h1.73l2.29,3.33.37.69h0l0-.69V26.56a2.87,2.87,0,0,1-.37-.15,1.84,1.84,0,0,1-.31-.2Zm9.67,5.6H90.54v-.3l.36-.14.42-.1V26.42h-.93l-.51,1.37h-.33c0-.11,0-.25-.07-.41s0-.34,0-.51,0-.35,0-.53,0-.32,0-.44h5.09c0,.13,0,.28,0,.45s0,.34,0,.52,0,.34-.05.51a3.14,3.14,0,0,1-.07.41H94l-.52-1.37h-.92V31l.41.1a1.69,1.69,0,0,1,.36.14Zm14.15-1.68h.33c0,.09,0,.19.06.31s0,.25,0,.38l0,.41c0,.13,0,.25,0,.36a1.92,1.92,0,0,1-.7.24,4.91,4.91,0,0,1-.86.08,4.11,4.11,0,0,1-1.21-.17,2.32,2.32,0,0,1-.92-.52,2.47,2.47,0,0,1-.59-.9,3.74,3.74,0,0,1-.2-1.32,3.49,3.49,0,0,1,.22-1.31,2.67,2.67,0,0,1,.62-.9,2.38,2.38,0,0,1,.89-.51,3.43,3.43,0,0,1,1.07-.17,5.44,5.44,0,0,1,1,.08,3,3,0,0,1,.7.2c0,.09,0,.2,0,.33s0,.28,0,.42l-.06.43-.07.36h-.34l-.44-1.21a.74.74,0,0,0-.23-.06,1.84,1.84,0,0,0-.33,0,1.4,1.4,0,0,0-.61.14,1.22,1.22,0,0,0-.52.42,2.12,2.12,0,0,0-.35.74,4.2,4.2,0,0,0-.13,1.08,3,3,0,0,0,.46,1.76,1.46,1.46,0,0,0,1.24.62,1.92,1.92,0,0,0,.38,0,.41.41,0,0,0,.21-.1Zm6.3,1.68h-2v-.3a1.15,1.15,0,0,1,.27-.14l.29-.1,2.07-5.16H115L117,31l.32.1a1.22,1.22,0,0,1,.28.14v.3h-2.51v-.3a3.27,3.27,0,0,1,.33-.14l.34-.1-.47-1.27h-1.77L113.05,31a2,2,0,0,1,.69.24Zm0-2.33h1.42l-.52-1.53-.16-.68h0l-.18.7Zm7.6,2.33v-.3a3.18,3.18,0,0,1,.32-.16A1.57,1.57,0,0,1,122,31V26.44a2.44,2.44,0,0,1-.33-.1,1.34,1.34,0,0,1-.32-.14v-.3h1.28l.58,0a5.72,5.72,0,0,1,.62,0,4.56,4.56,0,0,1,.75.06,2.09,2.09,0,0,1,.64.2,1.16,1.16,0,0,1,.45.4,1.26,1.26,0,0,1,.16.67,1.28,1.28,0,0,1-.09.48,1.19,1.19,0,0,1-.25.38,1.21,1.21,0,0,1-.39.28,1.45,1.45,0,0,1-.47.16v0a2.36,2.36,0,0,1,.51.12,1.33,1.33,0,0,1,.47.25,1.28,1.28,0,0,1,.34.42,1.26,1.26,0,0,1,.13.6,1.36,1.36,0,0,1-.19.74,1.49,1.49,0,0,1-.52.51,2.35,2.35,0,0,1-.74.3,4,4,0,0,1-.86.09h-.37l-.4,0h-1.65Zm2.06-3.1.27,0,.26,0a1.16,1.16,0,0,0,.5-.4,1,1,0,0,0,.19-.61.93.93,0,0,0-.26-.74,1,1,0,0,0-.68-.24h-.3l-.24,0v2Zm.35,2.63a1,1,0,0,0,.79-.3,1.08,1.08,0,0,0,.29-.8,1.21,1.21,0,0,0-.09-.5.91.91,0,0,0-.27-.31A1,1,0,0,0,124,29a2.6,2.6,0,0,0-.5,0h-.43v2l.24,0Zm8.59.47h-2.49v-.3a2.09,2.09,0,0,1,.64-.24V26.44l-.33-.09a1.28,1.28,0,0,1-.31-.15v-.3h2.49v.3a1.48,1.48,0,0,1-.31.15l-.33.09V31l.33.09a1.48,1.48,0,0,1,.31.15Zm7.6-5.6h2v.31a1.85,1.85,0,0,1-.33.21,1.59,1.59,0,0,1-.35.14v5h-.68l-2.82-4.08-.32-.62h0l.08.64v3.34a1.71,1.71,0,0,1,.35.13,1.69,1.69,0,0,1,.33.19v.3h-2v-.3a1.57,1.57,0,0,1,.31-.18,1.78,1.78,0,0,1,.36-.14V26.52l-.32-.15a2,2,0,0,1-.29-.17v-.3h1.73l2.3,3.33.36.69h0l0-.69V26.56a2.5,2.5,0,0,1-.38-.15,1.84,1.84,0,0,1-.31-.2Zm10,0c0,.24,0,.49,0,.74a6.85,6.85,0,0,1-.11.72h-.32l-.37-.94h-1.5v2h1l.35-.62h.26c0,.27,0,.56,0,.88s0,.61,0,.89h-.26l-.35-.63h-1V31h1.56l.43-1h.32a3.09,3.09,0,0,1,.07.35c0,.13,0,.26.05.39l0,.42c0,.13,0,.26,0,.38h-4.32v-.3a2.09,2.09,0,0,1,.3-.14l.35-.1V26.44a2.56,2.56,0,0,1-.34-.1,1.26,1.26,0,0,1-.31-.14v-.3Zm7.85,5.6H155v-.3l.37-.14.41-.1V26.42h-.93l-.51,1.37H154c0-.11,0-.25-.06-.41l-.06-.51c0-.18,0-.35,0-.53s0-.32,0-.44h5.09c0,.13,0,.28,0,.45s0,.34,0,.52l-.06.51c0,.16,0,.3-.06.41h-.33l-.51-1.37H157V31l.41.1a1.5,1.5,0,0,1,.36.14ZM25.86,0H10.14A10.14,10.14,0,0,0,0,10.14V25.86A10.14,10.14,0,0,0,10.14,36H25.86A10.14,10.14,0,0,0,36,25.86V10.14A10.14,10.14,0,0,0,25.86,0Zm-5,26.39c-3.09,0-4.61-.91-7.22-.92a7,7,0,0,0-3.86,1s.35-4.2,5.5-4.2c3.25,0,4.13.91,7.25.92a7.32,7.32,0,0,0,3.73-1S25.84,26.39,20.84,26.39Zm0-6.34c-3.09,0-4.61-.91-7.22-.92a6.92,6.92,0,0,0-3.86,1S10.11,16,15.26,16c3.25,0,4.13.91,7.25.92a7.41,7.41,0,0,0,3.73-1S25.84,20.05,20.84,20.05Zm0-6.33c-3.09,0-4.61-.92-7.22-.92a6.83,6.83,0,0,0-3.86,1s.35-4.21,5.5-4.21c3.25,0,4.13.91,7.25.92a7.31,7.31,0,0,0,3.73-1S25.84,13.72,20.84,13.72Z"></path>
                        </g>
                    </svg>
                </div>
            </div>
        </div>
        <div class="auth__table-row">
            <div class="auth__table-cell auth__table-cell_large">
                <!-- Auth Box Content -->
                <div class="auth__box">
                    <div class="auth__actions">
                        <a routerLink="/auth/sign-in" class="auth__action" [class.auth__action_active]="action !== 'sign-up'">{{ 'auth.sign_in__tab' | translate }}</a>
                        <a routerLink="/auth/sign-up" class="auth__action" [class.auth__action_active]="action === 'sign-up'">{{ 'auth.sign_up__tab' | translate }}</a>
                    </div>
                    <div class="auth__content">
                        <sign-in *ngIf="action === 'sign-in'" (onProgressStateChange)="onProgressStateChange($event)" (onAfterSignIn)="onAfterSignIn()"></sign-in>
                        <sign-up *ngIf="action === 'sign-up'" (onProgressStateChange)="onProgressStateChange($event)" (onAfterSignIn)="onAfterSignIn()"></sign-up>
                        <new-password *ngIf="action === 'new-password'" (onProgressStateChange)="onProgressStateChange($event)" (onAfterSignIn)="onAfterSignIn()"></new-password>
                        <forgot-password *ngIf="action === 'forgot-password'" (onProgressStateChange)="onProgressStateChange($event)"></forgot-password>
                        <reset-password *ngIf="action === 'reset-password'" (onProgressStateChange)="onProgressStateChange($event)"></reset-password>
                        <div class="auth__social" *ngIf="action === 'sign-in' || action === 'sign-up'">
                            <button type="button" class="button button_large auth__social-button auth__social-button_facebook" (click)="executeSocialAuth('Facebook')" [disabled]="isBusy">
                                <span class="button__caption">Facebook</span>
                            </button>
                            <button type="button" class="button button_large auth__social-button auth__social-button_google" (click)="executeSocialAuth('Google')" [disabled]="isBusy">
                                <span class="button__caption">Google</span>
                            </button>
                        </div>
                    </div>
                    <div class="auth__form-overlay" *ngIf="isBusy"></div>
                </div>
                <div class="auth__footer">
                    <div class="auth__language" [class.auth__language_active]="isLangMenuActive">
                        <button type="button" class="auth__language-trigger" (click)="toggleLangMenu($event)" [disabled]="isLangMenuDisabled">
                            {{ currentLang.nameKey | translate }}
                        </button>
                        <div class="auth__language-menu">
                            <button type="button" class="auth__language-menu-item" *ngFor="let lang of langs" (click)="onLanguageChange(lang)">
                                <i class="auth__language-menu-item-icon" *ngIf="userData.local.language === lang.code">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14px" height="11px" viewBox="0 0 14 11">
                                        <path fill="currentColor" d="M5,10.4L0.3,5.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0L5,7.6l7.3-7.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4L5,10.4z"></path>
                                    </svg>
                                </i>
                                <span class="auth__language-menu-item-text">
                                    {{ lang.name }} <ng-container *ngIf="userData.local.language !== lang.code">({{ lang.nameKey | translate }})</ng-container>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="auth__copyright">
                        <span>© {{ year }} OPENLECT LLC</span>
                        <a href="#" (click)="showTerms($event)">{{ 'auth.terms__link' | translate }}</a>
                    </div>
                </div>
                <!-- /Auth Box Content -->
            </div>
        </div>
    </div>
</ng-container>
