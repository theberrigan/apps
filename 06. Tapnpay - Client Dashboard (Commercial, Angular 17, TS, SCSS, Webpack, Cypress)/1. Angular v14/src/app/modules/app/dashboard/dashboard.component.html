<div class="dashboard__sidebar-nest" *ngIf="viewportBreakpoint === 'desktop'">
    <div class="dashboard__sidebar">
        <div class="dashboard__sidebar-scroll-area" [style.marginRight.px]="sidebarScrollAreaMarginRight">
            <div class="dashboard__sidebar-content">
                <div class="dashboard__sidebar-logo">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1442" height="420" class="dashboard__sidebar-logo-svg" preserveAspectRatio="xMidYMid meet">
                        <use xlink:href="#svg-logo"></use>
                    </svg>
                </div>
                <nav class="dashboard__sidebar-nav">
                    <ul class="dashboard__sidebar-nav-list">
                        <li>
                            <a routerLink="/dashboard/invoices" routerLinkActive="dashboard__sidebar-nav-link_active" class="dashboard__sidebar-nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" class="dashboard__sidebar-nav-link-icon">
                                    <path style="fill: currentColor;" d="M20,28H8a5,5,0,0,1-5-5V5A5,5,0,0,1,8,0H20a5,5,0,0,1,5,5V23A5,5,0,0,1,20,28ZM8,2A3,3,0,0,0,5,5V23a3,3,0,0,0,3,3H20a3,3,0,0,0,3-3V5a3,3,0,0,0-3-3Zm7,7H13a1,1,0,0,1,0-2h2a1,1,0,0,1,1,1h2a3,3,0,0,0-3-3V4H13V5a3,3,0,0,0,0,6h2a1,1,0,0,1,0,2H13a1,1,0,0,1-1-1H10a3,3,0,0,0,3,3v1h2V15a3,3,0,0,0,0-6Zm4,9H9v2H19Zm-3,4H9v2h7Z"></path>
                                </svg>
                                <span class="dashboard__sidebar-nav-link-text">{{ 'nav.items.invoices' | translate }}</span>
                            </a>
                        </li>
                        <li>
                            <a routerLink="/dashboard/history" routerLinkActive="dashboard__sidebar-nav-link_active" class="dashboard__sidebar-nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" class="dashboard__sidebar-nav-link-icon">
                                    <path style="fill: currentColor;" d="M28,14A12,12,0,0,1,7.51,22.49l1.42-1.42A10,10,0,1,0,6,14v1.59l2.29-2.3,1.42,1.42L5,19.41.29,14.71l1.42-1.42L4,15.59V14a12,12,0,1,1,24,0Zm-11-.4V7.74H15v7l6.06,3.5,1-1.74Z"></path>
                                </svg>
                                <span class="dashboard__sidebar-nav-link-text">{{ 'nav.items.history' | translate }}</span>
                            </a>
                        </li>
                    </ul>
                    <div class="dashboard__sidebar-nav-sep"></div>
                    <ul class="dashboard__sidebar-nav-list">
                        <li *ngIf="isCoverageVisible()">
                            <a routerLink="/dashboard/coverage" routerLinkActive="dashboard__sidebar-nav-link_active" class="dashboard__sidebar-nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" class="dashboard__sidebar-nav-link-icon">
                                    <path style="fill: currentColor;" d="M14,27.5l-.75-.84C12.92,26.29,5,17.3,5,10a9,9,0,0,1,18,0c0,7.3-7.92,16.29-8.25,16.66ZM14,3a7,7,0,0,0-7,7c0,5.31,5.06,12.05,7,14.44,1.94-2.39,7-9.13,7-14.44A7,7,0,0,0,14,3Zm0,11a4,4,0,1,1,4-4A4,4,0,0,1,14,14Zm0-6a2,2,0,1,0,2,2A2,2,0,0,0,14,8Z"></path>
                                </svg>
                                <span class="dashboard__sidebar-nav-link-text">{{ 'nav.items.toll_coverage' | translate }}</span>
                            </a>
                        </li>
                        <li>
                            <a routerLink="/dashboard/faq" routerLinkActive="dashboard__sidebar-nav-link_active" class="dashboard__sidebar-nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" class="dashboard__sidebar-nav-link-icon">
                                    <path style="fill: currentColor;" d="M14,26A12,12,0,1,1,26,14,12,12,0,0,1,14,26ZM14,4A10,10,0,1,0,24,14,10,10,0,0,0,14,4Zm-1.64,7.36h-2a3.23,3.23,0,0,1,1-2.49,3.88,3.88,0,0,1,2.76-1A4,4,0,0,1,16,8.3a3.1,3.1,0,0,1,1.24,1.17,3.05,3.05,0,0,1,.46,1.61,3,3,0,0,1-.14.9,3.82,3.82,0,0,1-.47.92,7.63,7.63,0,0,1-.9.92,5.59,5.59,0,0,0-.85.87,2.28,2.28,0,0,0-.29.68,5.22,5.22,0,0,0-.15,1.17H12.76v-.35a4.51,4.51,0,0,1,.39-1.9,4.6,4.6,0,0,1,1.24-1.61,6.73,6.73,0,0,0,1-1,1.22,1.22,0,0,0,.17-.64,1.07,1.07,0,0,0-.42-.85A1.71,1.71,0,0,0,14,9.84a1.65,1.65,0,0,0-1.18.43A1.43,1.43,0,0,0,12.36,11.36Zm1.5,6.07a1.34,1.34,0,0,1,1,.39,1.27,1.27,0,0,1,.4.95,1.25,1.25,0,0,1-.4.94,1.28,1.28,0,0,1-1,.4,1.31,1.31,0,0,1-1-.4,1.28,1.28,0,0,1-.39-.94,1.33,1.33,0,0,1,1.34-1.34Z"></path>
                                </svg>
                                <span class="dashboard__sidebar-nav-link-text">{{ 'nav.items.faq' | translate }}</span>
                            </a>
                        </li>
                        <li>
                            <a routerLink="/dashboard/contact-us" routerLinkActive="dashboard__sidebar-nav-link_active" class="dashboard__sidebar-nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" class="dashboard__sidebar-nav-link-icon">
                                    <path style="fill: currentColor;" d="M21,26a1,1,0,0,1-.65-.24L13.63,20H7a5,5,0,0,1-5-5V7A5,5,0,0,1,7,2H21a5,5,0,0,1,5,5v8a5,5,0,0,1-4,4.9V25a1,1,0,0,1-.58.91A1.06,1.06,0,0,1,21,26ZM7,4A3,3,0,0,0,4,7v8a3,3,0,0,0,3,3h7a1,1,0,0,1,.65.24L20,22.83V19a1,1,0,0,1,1-1,3,3,0,0,0,3-3V7a3,3,0,0,0-3-3ZM20,8H8v2H20Zm-4,4H8v2h8Z"></path>
                                </svg>
                                <span class="dashboard__sidebar-nav-link-text">{{ 'nav.items.contact_us' | translate }}</span>
                            </a>
                        </li>
                        <li>
                            <a routerLink="/dashboard/terms" routerLinkActive="dashboard__sidebar-nav-link_active" class="dashboard__sidebar-nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" class="dashboard__sidebar-nav-link-icon">
                                    <path style="fill: currentColor;" d="M20,28H8a5,5,0,0,1-5-5V5A5,5,0,0,1,8,0H20a5,5,0,0,1,5,5V23A5,5,0,0,1,20,28ZM8,2A3,3,0,0,0,5,5V23a3,3,0,0,0,3,3H20a3,3,0,0,0,3-3V5a3,3,0,0,0-3-3ZM19,7H9V9H19Zm0,4H9v2H19Zm0,4H9v2H19Zm0,5H14v2h5Z"></path>
                                </svg>
                                <span class="dashboard__sidebar-nav-link-text">{{ 'nav.items.terms' | translate }}</span>
                            </a>
                        </li>
                    </ul>
                </nav>
                <div class="dashboard__sidebar-footer">
                    &copy; 2021 tapNpay, Inc.
                </div>
            </div>
        </div>
    </div>
</div>
<div class="dashboard__content">
    <router-outlet></router-outlet>
</div>

<!-- Popups -->
<popup-custom class="dashboard__payment-popup" *ngIf="activePaymentPopup === 'payment'" [isDisabled]="paymentSubmittingBy !== null">
    <popup-content>
        <div [innerHTML]="payByMailConfirmMessageKey | translate : welcomeMessageData"></div>
        <input type="text" class="input input_large dashboard__payment-popup-zip"
            *ngIf="paymentConfig.payment_method_type === 'DCB' && isPaymentZipRequired"
            [(ngModel)]="zipCode"
            [placeholder]="'dashboard.payment.zip_code' | translate"
            (ngModelChange)="validatePaymentPopup()"
        >
    </popup-content>
    <popup-controls [isStretched]="true">
        <button type="button" class="button button_regular button_light-blue"
            (click)="onSubmitPayment(false)"
            [isDisabled]="paymentSubmittingBy !== null"
            [isProgress]="paymentSubmittingBy === 'no'"
        >
            <span class="button__caption">{{ 'dashboard.payment.no' | translate }}</span>
        </button>
        <button type="button" class="button button_regular button_blue"
            (click)="onSubmitPayment(true)"
            [isDisabled]="!isPaymentPopupValid || paymentSubmittingBy !== null"
            [isProgress]="paymentSubmittingBy === 'yes'"
        >
            <span class="button__caption">{{ 'dashboard.payment.yes' | translate }}</span>
        </button>
    </popup-controls>
</popup-custom>

<popup-custom class="dashboard__welcome-popup" *ngIf="activePaymentPopup === 'welcome'">
    <popup-content>
        <span [innerHTML]="welcomeMessageKey | translate : welcomeMessageData"></span>
    </popup-content>
    <popup-controls>
        <button type="button" class="button button_regular button_blue" (click)="hideWelcomeMessage()">
            <span class="button__caption">{{ 'dashboard.welcome.ok' | translate }}</span>
        </button>
    </popup-controls>
</popup-custom>

<popup-custom class="dashboard__fleet-lpn-popup" *ngIf="activePaymentPopup === 'fleet-lpn'" [isDisabled]="isConfirmingFleet">
    <popup-content>
        <div class="dashboard__fleet-lpn-popup-header">
            {{ 'dashboard.fleet.header_message' | translate }}
        </div>
        <div class="table table_middle table_striped table_reversed table_nowrap dashboard__fleet-lpn-popup-table">
            <div class="table__body">
                <div class="table__row" *ngFor="let plate of pendingLPNs.plates">
                    <div class="table__cell">
                        <checkbox
                            [disabled]="pendingLPNs.fee <= 0 && pendingLPNsActivity[plate.id] && activePendingLPNsCount === 1"
                            [(ngModel)]="pendingLPNsActivity[plate.id]"
                            (ngModelChange)="recountActivePendingLPNs()"
                        ></checkbox>
                    </div>
                    <div class="table__cell">
                        {{ plate.lps }} {{ plate.lpn }}
                    </div>
                    <div class="table__cell">
                        {{ pendingLPNs.fee | currency : 'USD' }}
                    </div>
                </div>
            </div>
        </div>
    </popup-content>
    <popup-controls>
        <button type="button" class="button button_regular button_blue"
            [isProgress]="isConfirmingFleet"
            [isDisabled]="isConfirmingFleet || !canSubmitOneTimePayment"
            (click)="onConfirmFleetPayment()"
            [ngSwitch]="activePendingLPNsTotal"
        >
            <span *ngSwitchCase="0" class="button__caption">
                {{ 'dashboard.fleet.submit_button' | translate }}
            </span>
            <span *ngSwitchDefault class="button__caption">
                {{ 'dashboard.fleet.pay_button' | translate : { amount: (activePendingLPNsTotal | currency : 'USD') } }}
            </span>
        </button>
    </popup-controls>
</popup-custom>

<popup-custom class="dashboard__fleet-lpn-zip-popup" *ngIf="activePaymentPopup === 'fleet-lpn-zip'" [isDisabled]="isFleetZipSubmitting">
    <popup-content>
        <input type="text" class="input input_large dashboard__fleet-lpn-zip-popup-zip"
            [(ngModel)]="zipCode"
            [placeholder]="'dashboard.fleet.zip_code' | translate"
            (ngModelChange)="validateFleetZipPopup()"
        >
    </popup-content>
    <popup-controls [isStretched]="true">
        <button type="button" class="button button_regular button_blue"
            (click)="submitFleetZipPayment()"
            [isDisabled]="!isFleetZipValid"
            [isProgress]="isFleetZipSubmitting"
        >
            <span class="button__caption">{{ 'dashboard.fleet.zip_pay' | translate }}</span>
        </button>
    </popup-controls>
</popup-custom>

<popup-custom class="dashboard__fleet-lpn-wallet-popup"
    *ngIf="activePaymentPopup === 'fleet-wallet-payment-confirm'"
    [isDisabled]="isFleetWalletSubmitting"
>
    <popup-content>
        <span [innerHTML]="'dashboard.fleet.wallet_confirm_message' | translate : { amount: walletFleetPaymentAttrs.amountFormatted, wallet: walletFleetPaymentAttrs.wallet }"></span>
    </popup-content>
    <popup-controls [isStretched]="true">
        <button type="button" class="button button_regular button_blue" [isProgress]="isFleetWalletSubmitting" (click)="onConfirmFleetWalletPayment()">
            <span class="button__caption">{{ 'dashboard.fleet.wallet_ok' | translate }}</span>
        </button>
    </popup-controls>
</popup-custom>

<popup-custom class="dashboard__debt-lock-popup" *ngIf="activePaymentPopup === 'account-debt-lock'">
    <popup-content>
        <span [innerHTML]="'debt_lock.welcome_message' | translate"></span>
    </popup-content>
    <popup-controls [isStretched]="true">
        <button type="button" class="button button_regular button_blue" (click)="onPayDebt()">
            <span class="button__caption">{{ 'debt_lock.pay_debt_button' | translate }}</span>
        </button>
    </popup-controls>
</popup-custom>

<payment-method
    *ngIf="activePaymentPopup === 'payment-method'"
    [mode]="paymentMethodPopupMode"
    [hideCancelButton]="true"
    [isSilentInit]="true"
    (onDone)="onPaymentMethodSelected($event)"
></payment-method>
